\ $Id$

Словарь BOT-COMMANDS содержит все команды которые будет воспринимать бот.
Логика обработки - каждое сообщение IRC парсится в контексте этого словаря
привычным для форта образом. Если слово найдено - оно выполняется. Само сообщение
доступно как входной поток, т.е. можно PARSE-ить и анализировать. Все слова
которых нет в этом словаре прерывают обработку.
Таким образом для того чтобы добавить реакцию на команду !say :

MODULE: BOT-COMMANDS \ будем добавлять слова в словарь BOT-COMMANDS

: !say
   0 PARSE \ выбираем всё сообщение
   FINE-HEAD FINE-TAIL \ чистим пробелы с хвоста и с начала
   ?DUP IF DROP S" Что сказать?" THEN \ ответ по умолчанию на пустую строку
   S-REPLY \ отвечаем
   ;
   
;MODULE \ закрываем словарь

Выполнять какие-то действия при коннекте к серверу можно в scatcoln'е AT-CONNECT :

..: AT-CONNECT S" I am connected" S" owner" S-SAY-TO ;.. \ отправить сообщение пользователю owner

Действия :
S-SAY ( a u -- ) \ отправить сообщение в канал (работает только после команды JOIN)
S-SAY-TO ( a u user-a user-u -- ) \ отправить сообщение конкретному пользователю
S-NOTICE-TO ( a u user-a user-u -- ) \ нотисом
S-REPLY ( a u -- ) \ ответить в контекст общения
S-NOTICE-REPLY ( a u -- ) \ нотисом

message-sender ( -- a u ) \ отправитель обрабатываемого сообщения


Для того чтобы добавить помощь по команде (!help !say):

MODULE: BOT-COMMANDS-HELP
: !say S" Usage: !say <message> - bot will reply <message>" S-REPLY ;
;MODULE

